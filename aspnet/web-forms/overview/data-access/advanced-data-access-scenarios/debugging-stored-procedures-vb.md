---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
title: Saklı yordamların hatalarını ayıklama (VB) | Microsoft Docs
author: rick-anderson
description: Visual Studio Professional ve Team System sürümleri, SQL Server içindeki saklı yordamlar için kesme noktaları ve adım adım ayarlamanıza olanak tanır...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 9ed8ccb5-5f31-4eb4-976d-cabf4b45ca09
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
msc.type: authoredcontent
ms.openlocfilehash: 13d213ef4baf493a4f05a82daae8d2dc3b0aa61b
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78551277"
---
# <a name="debugging-stored-procedures-vb"></a><span data-ttu-id="c01d6-103">Saklı Yordamların Hatalarını Ayıklama (VB)</span><span class="sxs-lookup"><span data-stu-id="c01d6-103">Debugging Stored Procedures (VB)</span></span>

<span data-ttu-id="c01d6-104">[Scott Mitchell](https://twitter.com/ScottOnWriting) tarafından</span><span class="sxs-lookup"><span data-stu-id="c01d6-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c01d6-105">[Kodu indirin](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip) veya [PDF 'yi indirin](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c01d6-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip) or [Download PDF](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span></span>

> <span data-ttu-id="c01d6-106">Visual Studio Professional ve Team System sürümleri, SQL Server içindeki saklı yordamlar için kesme noktaları ve adım adım ayarlamanıza olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-106">Visual Studio Professional and Team System editions allow you to set breakpoints and step in to stored procedures within SQL Server, making debugging stored procedures as easy as debugging application code.</span></span> <span data-ttu-id="c01d6-107">Bu öğreticide, doğrudan veritabanı hata ayıklaması ve saklı yordamların uygulama hata ayıklaması gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-107">This tutorial demonstrates direct database debugging and application debugging of stored procedures.</span></span>

## <a name="introduction"></a><span data-ttu-id="c01d6-108">Giriş</span><span class="sxs-lookup"><span data-stu-id="c01d6-108">Introduction</span></span>

<span data-ttu-id="c01d6-109">Visual Studio, zengin bir hata ayıklama deneyimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="c01d6-109">Visual Studio provides a rich debugging experience.</span></span> <span data-ttu-id="c01d6-110">Birkaç tuş vuruşu veya fareyi tıklamasıyla, bir programın yürütülmesini durdurmak ve durumunu ve denetim akışını incelemek için kesme noktaları kullanmak mümkündür.</span><span class="sxs-lookup"><span data-stu-id="c01d6-110">With a few keystrokes or clicks of the mouse, it s possible to use breakpoints to stop execution of a program and examine its state and control flow.</span></span> <span data-ttu-id="c01d6-111">Visual Studio, uygulama kodu hata ayıklamayla birlikte SQL Server içinden saklı yordamları hata ayıklama desteği sunar.</span><span class="sxs-lookup"><span data-stu-id="c01d6-111">Along with debugging application code, Visual Studio offers support for debugging stored procedures from within SQL Server.</span></span> <span data-ttu-id="c01d6-112">Tıpkı kesme noktaları, bir ASP.NET arka plan kodu sınıfı veya Iş mantığı katman sınıfının kodu içinde ayarlanabilir, bu nedenle saklı yordamların içine yerleştirilebilecek.</span><span class="sxs-lookup"><span data-stu-id="c01d6-112">Just like breakpoints can be set within the code of an ASP.NET code-behind class or Business Logic Layer class, so too can they be placed within stored procedures.</span></span>

<span data-ttu-id="c01d6-113">Bu öğreticide, Visual Studio 'daki Sunucu Gezgini saklı yordamlara adımlamayı ve saklı yordam çalışan ASP.NET uygulamasından çağrıldığında isabet kesme noktalarını ayarlamayı inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-113">In this tutorial we will look at stepping into stored procedures from the Server Explorer within Visual Studio as well as how to set breakpoints that are hit when the stored procedure is called from the running ASP.NET application.</span></span>

> [!NOTE]
> <span data-ttu-id="c01d6-114">Ne yazık ki, saklı yordamlar yalnızca Visual Studio 'nun Professional ve Team Systems sürümlerinde bulunabilir ve hata ayıklanamaz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-114">Unfortunately, stored procedures can only be stepped into and debugged through the Professional and Team Systems versions of Visual Studio.</span></span> <span data-ttu-id="c01d6-115">Visual Web Developer veya Visual Studio 'nun standart sürümünü kullanıyorsanız, saklı yordamların hatalarını ayıklamak için gerekli olan adımlara yol gösterecek şekilde okumaya hoş geldiniz, ancak bu adımları makinenizde çoğaltabileceksiniz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-115">If you are using Visual Web Developer or the standard version of Visual Studio, you are welcome to read along as we walk through the steps necessary to debug stored procedures, but you will not be able to replicate these steps on your machine.</span></span>

## <a name="sql-server-debugging-concepts"></a><span data-ttu-id="c01d6-116">SQL Server hata ayıklama kavramları</span><span class="sxs-lookup"><span data-stu-id="c01d6-116">SQL Server Debugging Concepts</span></span>

<span data-ttu-id="c01d6-117">Microsoft SQL Server 2005, tüm .NET derlemeleri tarafından kullanılan çalışma zamanı olan [ortak dil çalışma zamanı (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx)ile tümleştirme sağlamak üzere tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-117">Microsoft SQL Server 2005 was designed to provide integration with the [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), which is the runtime used by all .NET assemblies.</span></span> <span data-ttu-id="c01d6-118">Sonuç olarak, SQL Server 2005 yönetilen veritabanı nesnelerini destekler.</span><span class="sxs-lookup"><span data-stu-id="c01d6-118">Consequently, SQL Server 2005 supports managed database objects.</span></span> <span data-ttu-id="c01d6-119">Diğer bir deyişle, bir Visual Basic sınıfında yöntemler olarak saklı yordamlar ve Kullanıcı tanımlı Işlevler (UDF 'ler) gibi veritabanı nesneleri oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-119">That is, you can create database objects like stored procedures and User-Defined Functions (UDFs) as methods in a Visual Basic class.</span></span> <span data-ttu-id="c01d6-120">Bu, bu saklı yordamların ve UDF 'ların .NET Framework ve kendi özel sınıflarınızda işlevselliği kullanmasına olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="c01d6-120">This enables these stored procedures and UDFs to utilize functionality in the .NET Framework and from your own custom classes.</span></span> <span data-ttu-id="c01d6-121">Elbette SQL Server 2005, T-SQL veritabanı nesneleri için de destek sağlar.</span><span class="sxs-lookup"><span data-stu-id="c01d6-121">Of course, SQL Server 2005 also provides support for T-SQL database objects.</span></span>

<span data-ttu-id="c01d6-122">SQL Server 2005, T-SQL ve yönetilen veritabanı nesneleri için hata ayıklama desteği sunar.</span><span class="sxs-lookup"><span data-stu-id="c01d6-122">SQL Server 2005 offers debugging support for both T-SQL and managed database objects.</span></span> <span data-ttu-id="c01d6-123">Ancak, bu nesnelere yalnızca Visual Studio 2005 Professional ve Team Systems sürümlerinde hata ayıklanabilir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-123">However, these objects can only be debugged through Visual Studio 2005 Professional and Team Systems editions.</span></span> <span data-ttu-id="c01d6-124">Bu öğreticide, hata ayıklama T-SQL veritabanı nesneleri anlatılmaktadır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-124">In this tutorial we will examine debugging T-SQL database objects.</span></span> <span data-ttu-id="c01d6-125">Sonraki öğretici, yönetilen veritabanı nesnelerinde hata ayıklama işlemini inceler.</span><span class="sxs-lookup"><span data-stu-id="c01d6-125">The subsequent tutorial looks at debugging managed database objects.</span></span>

<span data-ttu-id="c01d6-126">[SQL Server 2005 CLR Integration ekibinin](https://blogs.msdn.com/sqlclr/default.aspx) [SQL Server 2005 blog GIRIŞINDE T-SQL ve clr hata ayıklamasına genel bakış](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) , Visual Studio 'dan SQL Server 2005 nesnelerinde hata ayıklamanın üç yolunu vurgular:</span><span class="sxs-lookup"><span data-stu-id="c01d6-126">The [Overview of T-SQL and CLR Debugging in SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) blog entry from the [SQL Server 2005 CLR Integration team](https://blogs.msdn.com/sqlclr/default.aspx) highlights the three ways to debug SQL Server 2005 objects from Visual Studio:</span></span>

- <span data-ttu-id="c01d6-127">**Doğrudan veritabanı hata ayıklaması (DDD)** -Sunucu Gezgini, saklı yordamlar ve UDF 'ler gibi herhangi bir T-SQL veritabanı nesnesine ilerliyoruz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-127">**Direct Database Debugging (DDD)** - from Server Explorer we can step into any T-SQL database object, such as stored procedures and UDFs.</span></span> <span data-ttu-id="c01d6-128">Adım 1 ' de DDD ' i inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-128">We will examine DDD in Step 1.</span></span>
- <span data-ttu-id="c01d6-129">**Uygulama hata ayıklaması** -bir veritabanı nesnesi içinde kesme noktaları ayarlayabiliyoruz ve sonra ASP.net uygulamamızı çalıştırabiliriz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-129">**Application Debugging** - we can set breakpoints within a database object and then run our ASP.NET application.</span></span> <span data-ttu-id="c01d6-130">Veritabanı nesnesi yürütüldüğünde, kesme noktasına isabet edilir ve denetim hata ayıklayıcıya açılır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-130">When the database object is executed, the breakpoint will be hit and control turned over to the debugger.</span></span> <span data-ttu-id="c01d6-131">Uygulama hata ayıklaması ile uygulama kodundan bir veritabanı nesnesine ilerliyoruz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-131">Note that with application debugging we cannot step into a database object from application code.</span></span> <span data-ttu-id="c01d6-132">Hata ayıklayıcının durdurulmasını istediğimiz, bu saklı yordamlarda veya UDF 'de açıkça kesme noktaları ayarlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-132">We must explicitly set breakpoints in those stored procedures or UDFs where we want the debugger to stop.</span></span> <span data-ttu-id="c01d6-133">Uygulama hata ayıklaması adım 2 ' den başlayarak incelenir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-133">Application debugging is examined starting in Step 2.</span></span>
- <span data-ttu-id="c01d6-134">**SQL Server projeden hata ayıklama** -Visual Studio Professional ve ekip sistemleri sürümleri, yönetilen veritabanı nesneleri oluşturmak için yaygın olarak kullanılan bir SQL Server proje türü içerir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-134">**Debugging from a SQL Server Project** - Visual Studio Professional and Team Systems editions include a SQL Server Project type that is commonly used to create managed database objects.</span></span> <span data-ttu-id="c01d6-135">SQL Server projelerini kullanarak bir sonraki öğreticide içeriklerinin hatalarını ayıklacağız.</span><span class="sxs-lookup"><span data-stu-id="c01d6-135">We will examine using SQL Server Projects and debugging their contents in the next tutorial.</span></span>

<span data-ttu-id="c01d6-136">Visual Studio, yerel ve uzak SQL Server örneklerinde saklı yordamların hatalarını ayıklayabilir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-136">Visual Studio can debug stored procedures on local and remote SQL Server instances.</span></span> <span data-ttu-id="c01d6-137">Yerel bir SQL Server örneği, Visual Studio ile aynı makineye yüklenmiş biridir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-137">A local SQL Server instance is one that is installed on the same machine as Visual Studio.</span></span> <span data-ttu-id="c01d6-138">Kullanmakta olduğunuz SQL Server veritabanı geliştirme makinenizde bulunmuyorsa, uzak bir örnek olarak kabul edilir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-138">If the SQL Server database you are using is not located on your development machine, then it is considered a remote instance.</span></span> <span data-ttu-id="c01d6-139">Bu öğreticiler için yerel SQL Server örnekleri kullandık.</span><span class="sxs-lookup"><span data-stu-id="c01d6-139">For these tutorials we have been using local SQL Server instances.</span></span> <span data-ttu-id="c01d6-140">Uzak bir SQL Server örneğinde saklı yordamların hata ayıklaması, yerel bir örnekteki saklı yordamların hata ayıklamasının dışında daha fazla yapılandırma adımı gerektirir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-140">Debugging stored procedures on a remote SQL server instance requires more configuration steps than when debugging stored procedures on a local instance.</span></span>

<span data-ttu-id="c01d6-141">Yerel bir SQL Server örneği kullanıyorsanız, 1. adımla başlayabilir ve bu öğreticiden sonuna kadar çalışabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-141">If you are using a local SQL Server instance, you can start with Step 1 and work through this tutorial to the end.</span></span> <span data-ttu-id="c01d6-142">Ancak uzak bir SQL Server örneği kullanıyorsanız, ilk olarak hata ayıklama sırasında, uzak örnekte SQL Server bir oturum açmaya sahip bir Windows kullanıcı hesabıyla geliştirme makinenize oturum açtığınızı doğrulayın.</span><span class="sxs-lookup"><span data-stu-id="c01d6-142">If you are using a remote SQL Server instance, however, you will first need to ensure that when debugging you are logged to your development machine with a Windows user account that has a SQL Server login on the remote instance.</span></span> <span data-ttu-id="c01d6-143">Üstelik, çalışan ASP.NET uygulamasından veritabanına bağlanmak için kullanılan bu veritabanı oturum açma ve veritabanı oturum açmanın `sysadmin` rolün üyesi olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-143">Moreover, both this database login and the database login used to connect to the database from the running ASP.NET application must be members of the `sysadmin` role.</span></span> <span data-ttu-id="c01d6-144">Visual Studio 'Yu yapılandırma hakkında daha fazla bilgi için ve uzak bir örnekte hata ayıklamak üzere SQL Server, Bu öğreticinin sonundaki uzak örneklerdeki hata ayıklama T-SQL veritabanı nesneleri bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="c01d6-144">See the Debugging T-SQL Database Objects on Remote Instances section at the end of this tutorial for more information on configuring Visual Studio and SQL Server to debug a remote instance.</span></span>

<span data-ttu-id="c01d6-145">Son olarak, T-SQL veritabanı nesneleri için hata ayıklama desteğinin, .NET uygulamaları için hata ayıklama desteği olarak zengin özellik olarak olduğunu anlayın.</span><span class="sxs-lookup"><span data-stu-id="c01d6-145">Finally, understand that debugging support for T-SQL database objects is not as feature rich as debugging support for .NET applications.</span></span> <span data-ttu-id="c01d6-146">Örneğin, kesme noktası koşulları ve filtreleri desteklenmez, yalnızca hata ayıklama pencerelerinin bir alt kümesi kullanılabilir; Düzenle ve devam et kullanamazsınız, acil pencere kullanılamaz ve bu şekilde işlenir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-146">For example, breakpoint conditions and filters are not supported, only a subset of the debugging windows are available, you cannot use Edit and Continue, the Immediate window is rendered useless, and so forth.</span></span> <span data-ttu-id="c01d6-147">Daha fazla bilgi için bkz. [hata ayıklayıcı komutlarında ve özelliklerinde sınırlamalar](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) .</span><span class="sxs-lookup"><span data-stu-id="c01d6-147">See [Limitations on Debugger Commands and Features](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) for more information.</span></span>

## <a name="step-1-directly-stepping-into-a-stored-procedure"></a><span data-ttu-id="c01d6-148">1\. Adım: doğrudan bir saklı yordama adımla</span><span class="sxs-lookup"><span data-stu-id="c01d6-148">Step 1: Directly Stepping Into a Stored Procedure</span></span>

<span data-ttu-id="c01d6-149">Visual Studio, bir veritabanı nesnesinin doğrudan hata ayıklamasını kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-149">Visual Studio makes it easy to directly debug a database object.</span></span> <span data-ttu-id="c01d6-150">Northwind veritabanında `Products_SelectByCategoryID` saklı yordamın içine geçmek için doğrudan veritabanı hata ayıklama (DDD) özelliğinin nasıl kullanılacağına göz atalım.</span><span class="sxs-lookup"><span data-stu-id="c01d6-150">Let s look at how to use the Direct Database Debugging (DDD) feature to step into the `Products_SelectByCategoryID` stored procedure in the Northwind database.</span></span> <span data-ttu-id="c01d6-151">Adından da anlaşılacağı gibi, `Products_SelectByCategoryID` belirli bir kategori için ürün bilgilerini döndürür; [yazılan veri kümesi s TableAdapters öğreticisi Için mevcut saklı yordamlar kullanılarak](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) oluşturulmuştur.</span><span class="sxs-lookup"><span data-stu-id="c01d6-151">As its name implies, `Products_SelectByCategoryID` returns product information for a particular category; it was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="c01d6-152">Sunucu Gezgini giderek başlayın ve Northwind veritabanı düğümünü genişletin.</span><span class="sxs-lookup"><span data-stu-id="c01d6-152">Start by going to the Server Explorer and expand the Northwind database node.</span></span> <span data-ttu-id="c01d6-153">Ardından, saklı yordamlar klasörünün detayına gidin, `Products_SelectByCategoryID` saklı yordamına sağ tıklayın ve bağlam menüsünde saklı yordam seçeneğine adımla seçeneğini belirleyin.</span><span class="sxs-lookup"><span data-stu-id="c01d6-153">Next, drill down into the Stored Procedures folder, right-click on the `Products_SelectByCategoryID` stored procedure, and choose the Step Into Stored Procedure option from the context menu.</span></span> <span data-ttu-id="c01d6-154">Bu işlem hata ayıklayıcıyı başlatır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-154">This will start the debugger.</span></span>

<span data-ttu-id="c01d6-155">`Products_SelectByCategoryID` saklı yordamı bir `@CategoryID` giriş parametresi beklediği için, bu değeri sağlamamız istenir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-155">Since the `Products_SelectByCategoryID` stored procedure expects a `@CategoryID` input parameter, we are asked to provide this value.</span></span> <span data-ttu-id="c01d6-156">İçecek hakkında bilgi döndüren 1 yazın.</span><span class="sxs-lookup"><span data-stu-id="c01d6-156">Enter 1, which will return information about the beverages.</span></span>

![@CategoryID parametresi için 1 değerini kullanın](debugging-stored-procedures-vb/_static/image1.png)

<span data-ttu-id="c01d6-158">**Şekil 1**: `@CategoryID` parametresi Için 1 değerini kullanın</span><span class="sxs-lookup"><span data-stu-id="c01d6-158">**Figure 1**: Use the Value 1 for the `@CategoryID` Parameter</span></span>

<span data-ttu-id="c01d6-159">`@CategoryID` parametresi için değer verdikten sonra, saklı yordam yürütülür.</span><span class="sxs-lookup"><span data-stu-id="c01d6-159">After supplying the value for the `@CategoryID` parameter, the stored procedure is executed.</span></span> <span data-ttu-id="c01d6-160">, Ancak tamamlanmayı çalıştırmak yerine, hata ayıklayıcı ilk ifadede yürütmeyi halden çıkarır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-160">Rather than running to completion, though, the debugger halts execution on the first statement.</span></span> <span data-ttu-id="c01d6-161">Kenar boşluğunda, saklı yordamdaki geçerli konumu belirten Sarı oka göz önünde bulundurma.</span><span class="sxs-lookup"><span data-stu-id="c01d6-161">Note the yellow arrow in the margin, indicating the current location in the stored procedure.</span></span> <span data-ttu-id="c01d6-162">İzleme penceresi veya saklı yordamdaki parametre adının üzerine gelerek parametre değerlerini görüntüleyebilir ve düzenleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-162">You can view and edit parameter values through the Watch window or by hovering over the parameter name in the stored procedure.</span></span>

<span data-ttu-id="c01d6-163">[Hata ayıklayıcının, saklı yordamın Ilk Ifadesinde durdurdu ![](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="c01d6-163">[![The Debugger has Halted on the First Statement of the Stored Procedure](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span></span>

<span data-ttu-id="c01d6-164">**Şekil 2**: hata ayıklayıcı saklı yordamın Ilk ifadesinde durdu ([tam boyutlu görüntüyü görüntülemek için tıklayın](debugging-stored-procedures-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="c01d6-164">**Figure 2**: The Debugger has Halted on the First Statement of the Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image4.png))</span></span>

<span data-ttu-id="c01d6-165">Saklı yordamı tek seferde bir deyime göre ilerlemek için, araç çubuğundaki adımla düğmesine tıklayın veya F10 tuşuna basın.</span><span class="sxs-lookup"><span data-stu-id="c01d6-165">To step through the stored procedure one statement at a time, click the Step Over button in the Toolbar or hit the F10 key.</span></span> <span data-ttu-id="c01d6-166">`Products_SelectByCategoryID` saklı yordamı tek bir `SELECT` ifadesini içerir, bu nedenle F10 'e vurarak tek deyimin üzerinde adım adım olur ve saklı yordamın yürütülmesi tamamlanır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-166">The `Products_SelectByCategoryID` stored procedure contains a single `SELECT` statement, so hitting F10 will step over the single statement and complete the execution of the stored procedure.</span></span> <span data-ttu-id="c01d6-167">Saklı yordam tamamlandıktan sonra çıktısı çıkış penceresinde görünür ve hata ayıklayıcı sonlandırılır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-167">After the stored procedure has completed, its output will appear in the Output window and the debugger will terminate.</span></span>

> [!NOTE]
> <span data-ttu-id="c01d6-168">T-SQL hata ayıklama, ifade düzeyinde oluşur; `SELECT` ifadeye ilerlenemez.</span><span class="sxs-lookup"><span data-stu-id="c01d6-168">T-SQL debugging occurs at the statement level; you cannot step into a `SELECT` statement.</span></span>

## <a name="step-2-configuring-the-website-for-application-debugging"></a><span data-ttu-id="c01d6-169">2\. Adım: uygulama hata ayıklaması için Web sitesini yapılandırma</span><span class="sxs-lookup"><span data-stu-id="c01d6-169">Step 2: Configuring the Website for Application Debugging</span></span>

<span data-ttu-id="c01d6-170">Saklı yordamda doğrudan Sunucu Gezgini hata ayıklaması yaparken, ASP.NET uygulamamızda çağrıldığında, saklı yordamda hata ayıklamayla ilgili birçok senaryoda daha fazla senaryo olması yararlı olur.</span><span class="sxs-lookup"><span data-stu-id="c01d6-170">While debugging a stored procedure directly from the Server Explorer is handy, in many scenarios we are more interested in debugging the stored procedure when it is called from our ASP.NET application.</span></span> <span data-ttu-id="c01d6-171">Visual Studio içinden bir saklı yordama kesme noktaları ekleyebiliriz ve sonra ASP.NET uygulamasında hata ayıklamaya başlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-171">We can add breakpoints to a stored procedure from within Visual Studio and then start debugging the ASP.NET application.</span></span> <span data-ttu-id="c01d6-172">Uygulamadan kesme noktaları olan bir saklı yordam çağrıldığında, yürütme kesme noktasında durabilir ve 1. adımda yaptığımız gibi, saklı yordamın parametre değerlerini görüntüleyip değiştirebiliyoruz ve deyimlerini adım adım izleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-172">When a stored procedure with breakpoints is invoked from the application, execution will halt at the breakpoint and we can view and change the stored procedure s parameter values and step through its statements, just like we did in Step 1.</span></span>

<span data-ttu-id="c01d6-173">Uygulamadan çağrılan saklı yordamları hata ayıklamaya başlayabilmemiz için, ASP.NET Web uygulamasına SQL Server hata ayıklayıcı ile tümleştirileceğini söylemek istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-173">Before we can start debugging stored procedures called from the application, we need to instruct the ASP.NET web application to integrate with the SQL Server debugger.</span></span> <span data-ttu-id="c01d6-174">Çözüm Gezgini (`ASPNET_Data_Tutorial_74_VB`) Web sitesinin adına sağ tıklayıp başlatın.</span><span class="sxs-lookup"><span data-stu-id="c01d6-174">Start by right-clicking on the website name in the Solution Explorer (`ASPNET_Data_Tutorial_74_VB`).</span></span> <span data-ttu-id="c01d6-175">Bağlam menüsünden Özellik sayfaları seçeneğini belirleyin, sol taraftaki başlangıç seçenekleri öğesini seçin ve hata ayıklayıcıları bölümündeki SQL Server onay kutusunu işaretleyin (bkz. Şekil 3).</span><span class="sxs-lookup"><span data-stu-id="c01d6-175">Choose the Property Pages option from the context menu, select the Start Options item on the left, and check the SQL Server checkbox in the Debuggers section (see Figure 3).</span></span>

<span data-ttu-id="c01d6-176">[Uygulama ![özellik sayfalarındaki SQL Server onay kutusunu Işaretleyin](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="c01d6-176">[![Check the SQL Server Checkbox in the Application s Property Pages](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span></span>

<span data-ttu-id="c01d6-177">**Şekil 3**: uygulama öğeleri özellik sayfalarındaki SQL Server onay kutusunu işaretleyin ([tam boyutlu görüntüyü görüntülemek için tıklayın](debugging-stored-procedures-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="c01d6-177">**Figure 3**: Check the SQL Server Checkbox in the Application s Property Pages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image7.png))</span></span>

<span data-ttu-id="c01d6-178">Ayrıca, bağlantı havuzunun devre dışı bırakılması için uygulama tarafından kullanılan veritabanı bağlantı dizesini güncelleştirmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-178">Additionally, we need to update the database connection string used by the application so that connection pooling is disabled.</span></span> <span data-ttu-id="c01d6-179">Bir veritabanına bağlantı kapatıldığında, karşılık gelen `SqlConnection` nesnesi kullanılabilir bir bağlantı havuzuna yerleştirilir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-179">When a connection to a database is closed, the corresponding `SqlConnection` object is placed in a pool of available connections.</span></span> <span data-ttu-id="c01d6-180">Bir veritabanına bağlantı kurarken, yeni bir bağlantı oluşturmak ve kurmak zorunda kalmak yerine, kullanılabilir bir bağlantı nesnesi bu havuzdan alınabilir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-180">When establishing a connection to a database, an available connection object can be retrieved from this pool rather than having to create and establish a new connection.</span></span> <span data-ttu-id="c01d6-181">Bu bağlantı nesneleri havuzu bir performans geliştirmedir ve varsayılan olarak etkindir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-181">This pooling of connection objects is a performance enhancement and is enabled by default.</span></span> <span data-ttu-id="c01d6-182">Ancak, hata ayıklarken hata ayıklama altyapısı havuzdan alınan bir bağlantıyla çalışırken doğru şekilde yeniden kurulmadığı için bağlantı havuzunu kapatmak istiyoruz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-182">However, when debugging we want to turn off connection pooling because the debugging infrastructure is not correctly reestablished when working with a connection that was taken from the pool.</span></span>

<span data-ttu-id="c01d6-183">Bağlantı kuyruğunu devre dışı bırakmak için, `Web.config` `NORTHWNDConnectionString` `Pooling=false` ayarını içerecek şekilde güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="c01d6-183">To disabled connection pooling, update the `NORTHWNDConnectionString` in `Web.config` so that it includes the setting `Pooling=false` .</span></span>

[!code-xml[Main](debugging-stored-procedures-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="c01d6-184">ASP.NET uygulaması aracılığıyla SQL Server hata ayıklamayı tamamladıktan sonra, `Pooling` ayarını bağlantı dizesinden kaldırarak (veya `Pooling=true` olarak ayarlayarak) bağlantı havuzunu yeniden devreye sokduğunuzdan emin olun.</span><span class="sxs-lookup"><span data-stu-id="c01d6-184">Once you have finished debugging SQL Server through the ASP.NET application be sure to reinstate connection pooling by removing the `Pooling` setting from the connection string (or by setting it to `Pooling=true` ).</span></span>

<span data-ttu-id="c01d6-185">Bu noktada, ASP.NET uygulaması, Web uygulaması aracılığıyla çağrıldığında, Visual Studio 'Nun SQL Server veritabanı nesnelerinde hata ayıklamasına izin verecek şekilde yapılandırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-185">At this point the ASP.NET application has been configured to allow Visual Studio to debug SQL Server database objects when invoked through the web application.</span></span> <span data-ttu-id="c01d6-186">Artık kalan işlemler, saklı yordama bir kesme noktası eklemek ve hata ayıklamayı başlatacak!</span><span class="sxs-lookup"><span data-stu-id="c01d6-186">All that remains now is to add a breakpoint to a stored procedure and start debugging!</span></span>

## <a name="step-3-adding-a-breakpoint-and-debugging"></a><span data-ttu-id="c01d6-187">3\. Adım: kesme noktası ve hata ayıklama ekleme</span><span class="sxs-lookup"><span data-stu-id="c01d6-187">Step 3: Adding a Breakpoint and Debugging</span></span>

<span data-ttu-id="c01d6-188">`Products_SelectByCategoryID` saklı yordamını açın ve uygun yerdeki kenar boşluğuna tıklayarak ya da imlecinizi `SELECT` deyimin başlangıcında yerleştirip F9 tuşuna basarak `SELECT` deyimin başlangıcında bir kesme noktası ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="c01d6-188">Open the `Products_SelectByCategoryID` stored procedure and set a breakpoint at the start of the `SELECT` statement by clicking in the margin at the appropriate place or by placing your cursor at the start of the `SELECT` statement and hitting F9.</span></span> <span data-ttu-id="c01d6-189">Şekil 4 ' te gösterildiği gibi, kesme noktası kenar boşluğunda kırmızı bir daire olarak görünür.</span><span class="sxs-lookup"><span data-stu-id="c01d6-189">As Figure 4 illustrates, the breakpoint appears as a red circle in the margin.</span></span>

<span data-ttu-id="c01d6-190">[Products_SelectByCategoryID saklı yordamında bir kesme noktası ayarlamak ![](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="c01d6-190">[![Set a Breakpoint in the Products_SelectByCategoryID Stored Procedure](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span></span>

<span data-ttu-id="c01d6-191">**Şekil 4**: `Products_SelectByCategoryID` saklı yordamında bir kesme noktası ayarlayın ([tam boyutlu görüntüyü görüntülemek için tıklayın](debugging-stored-procedures-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="c01d6-191">**Figure 4**: Set a Breakpoint in the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image10.png))</span></span>

<span data-ttu-id="c01d6-192">Bir SQL veritabanı nesnesinin hata ayıklaması için bir istemci uygulama aracılığıyla ayıklanmak üzere, veritabanının uygulama hata ayıklamasını destekleyecek şekilde yapılandırılması zorunludur.</span><span class="sxs-lookup"><span data-stu-id="c01d6-192">In order for a SQL database object to be debugged through a client application, it is imperative that the database be configured to support application debugging.</span></span> <span data-ttu-id="c01d6-193">İlk olarak bir kesme noktası ayarladığınızda, bu ayarın otomatik olarak ayarlanması gerekir, ancak bu ayar, iki kez denetim altına alınmıştır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-193">When you first set a breakpoint, this setting should automatically be switched on, but it is prudent to double-check.</span></span> <span data-ttu-id="c01d6-194">Sunucu Gezgini `NORTHWND.MDF` düğümüne sağ tıklayın.</span><span class="sxs-lookup"><span data-stu-id="c01d6-194">Right-click on the `NORTHWND.MDF` node in the Server Explorer.</span></span> <span data-ttu-id="c01d6-195">Bağlam menüsü, uygulama hata ayıklaması adlı işaretli bir menü öğesi içermelidir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-195">The context menu should include a checked menu item named Application Debugging .</span></span>

![Uygulama hata ayıklama seçeneğinin etkinleştirildiğinden emin olun](debugging-stored-procedures-vb/_static/image11.png)

<span data-ttu-id="c01d6-197">**Şekil 5**: uygulama hata ayıklama seçeneğinin etkinleştirildiğinden emin olun</span><span class="sxs-lookup"><span data-stu-id="c01d6-197">**Figure 5**: Ensure that the Application Debugging Option is Enabled</span></span>

<span data-ttu-id="c01d6-198">Kesme noktası kümesi ve uygulama hata ayıklama seçeneği etkinken, ASP.NET uygulamasından çağrıldığında saklı yordamda hata ayıklamaya hazırız.</span><span class="sxs-lookup"><span data-stu-id="c01d6-198">With the breakpoint set and the Application Debugging option enabled, we are ready to debug the stored procedure when called from the ASP.NET application.</span></span> <span data-ttu-id="c01d6-199">Hata ayıklama menüsüne gidip hata ayıklamayı Başlat ' ı seçerek, F5 tuşuna basarak veya araç çubuğundaki yeşil yürütme simgesine tıklayarak hata ayıklayıcıyı başlatın.</span><span class="sxs-lookup"><span data-stu-id="c01d6-199">Start the debugger by going to the Debug menu and choosing Start Debugging, by hitting F5, or by clicking the green play icon in the Toolbar.</span></span> <span data-ttu-id="c01d6-200">Bu işlem hata ayıklayıcıyı başlatacak ve Web sitesini başlatacaktır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-200">This will start the debugger and launch the website.</span></span>

<span data-ttu-id="c01d6-201">`Products_SelectByCategoryID` saklı yordamı, [yazılan veri kümesi s TableAdapters öğreticisi Için mevcut saklı yordamlar kullanılarak](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) oluşturulmuştur.</span><span class="sxs-lookup"><span data-stu-id="c01d6-201">The `Products_SelectByCategoryID` stored procedure was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="c01d6-202">Karşılık gelen Web sayfası (`~/AdvancedDAL/ExistingSprocs.aspx`), bu saklı yordam tarafından döndürülen sonuçları görüntüleyen bir GridView içerir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-202">Its corresponding web page (`~/AdvancedDAL/ExistingSprocs.aspx`) contains a GridView that displays the results returned by this stored procedure.</span></span> <span data-ttu-id="c01d6-203">Tarayıcı aracılığıyla bu sayfayı ziyaret edin.</span><span class="sxs-lookup"><span data-stu-id="c01d6-203">Visit this page through the browser.</span></span> <span data-ttu-id="c01d6-204">Sayfaya ulaştıktan sonra, `Products_SelectByCategoryID` saklı yordamdaki kesme noktasına isabet edilir ve bu denetim Visual Studio 'ya döndürülür.</span><span class="sxs-lookup"><span data-stu-id="c01d6-204">Upon reaching the page, the breakpoint in the `Products_SelectByCategoryID` stored procedure will be hit and control returned to Visual Studio.</span></span> <span data-ttu-id="c01d6-205">1\. adımda olduğu gibi, saklı yordam deyimlerini kullanarak, parametre değerlerini görüntüleyebilir ve değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-205">Just like in Step 1, you can step through the stored procedure s statements and view and modify the parameter values.</span></span>

<span data-ttu-id="c01d6-206">[ExistingSprocs. aspx sayfasında Ilk olarak Içecek görüntülenir ![](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="c01d6-206">[![The ExistingSprocs.aspx Page Initially Displays the Beverages](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span></span>

<span data-ttu-id="c01d6-207">**Şekil 6**: `ExistingSprocs.aspx` sayfası başlangıçta alkolu görüntüler ([tam boyutlu görüntüyü görüntülemek için tıklayın](debugging-stored-procedures-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="c01d6-207">**Figure 6**: The `ExistingSprocs.aspx` Page Initially Displays the Beverages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image14.png))</span></span>

<span data-ttu-id="c01d6-208">[![saklı yordam kesme noktasına ulaşıldı](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="c01d6-208">[![The Stored Procedure s Breakpoint has been Reached](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span></span>

<span data-ttu-id="c01d6-209">**Şekil 7**: saklı yordam kesme noktasına ulaşıldı ([tam boyutlu görüntüyü görüntülemek için tıklayın](debugging-stored-procedures-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="c01d6-209">**Figure 7**: The Stored Procedure s Breakpoint has been Reached ([Click to view full-size image](debugging-stored-procedures-vb/_static/image17.png))</span></span>

<span data-ttu-id="c01d6-210">Şekil 7 ' deki izleme penceresi gösterdiği gibi, `@CategoryID` parametresinin değeri 1 ' dir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-210">As the Watch window in Figure 7 shows, the value of the `@CategoryID` parameter is 1.</span></span> <span data-ttu-id="c01d6-211">Bunun nedeni, `ExistingSprocs.aspx` sayfanın başlangıçta `CategoryID` değeri 1 olan içecek kategorisindeki ürünleri görüntülemektedir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-211">This is because the `ExistingSprocs.aspx` page initially displays products in the beverages category, which has a `CategoryID` value of 1.</span></span> <span data-ttu-id="c01d6-212">Açılan listeden farklı bir kategori seçin.</span><span class="sxs-lookup"><span data-stu-id="c01d6-212">Choose a different category from the drop-down list.</span></span> <span data-ttu-id="c01d6-213">Bunun yapılması geri göndermeye neden olur ve `Products_SelectByCategoryID` saklı yordamını yeniden yürütür.</span><span class="sxs-lookup"><span data-stu-id="c01d6-213">Doing so causes a postback and re-executes the `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="c01d6-214">Kesme noktası bir kez daha, ancak bu kez `@CategoryID` parametresi değeri seçili aşağı açılan liste öğesi s `CategoryID`yansıtır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-214">The breakpoint is hit again, but this time the `@CategoryID` parameter s value reflects the selected drop-down list item s `CategoryID`.</span></span>

<span data-ttu-id="c01d6-215">[![aşağı açılan listeden farklı bir kategori seçin](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="c01d6-215">[![Choose a Different Category from the Drop-Down List](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span></span>

<span data-ttu-id="c01d6-216">**Şekil 8**: açılan listeden farklı bir kategori seçin ([tam boyutlu görüntüyü görüntülemek için tıklayın](debugging-stored-procedures-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="c01d6-216">**Figure 8**: Choose a Different Category from the Drop-Down List ([Click to view full-size image](debugging-stored-procedures-vb/_static/image20.png))</span></span>

<span data-ttu-id="c01d6-217">[![@CategoryID parametresi, Web sayfasından Seçilen kategoriyi yansıtır](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="c01d6-217">[![The @CategoryID Parameter Reflects the Category Selected from the Web Page](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span></span>

<span data-ttu-id="c01d6-218">**Şekil 9**: `@CategoryID` parametresi, Web sayfasından Seçilen kategoriyi yansıtır ([tam boyutlu görüntüyü görüntülemek için tıklayın](debugging-stored-procedures-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="c01d6-218">**Figure 9**: The `@CategoryID` Parameter Reflects the Category Selected from the Web Page ([Click to view full-size image](debugging-stored-procedures-vb/_static/image23.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c01d6-219">`ExistingSprocs.aspx` sayfasını ziyaret ederken `Products_SelectByCategoryID` saklı yordamdaki kesme noktası isabet ettirilmediğinde, SQL Server onay kutusunun ASP.NET uygulama özellikleri sayfasının hata ayıklayıcıları bölümünde işaretli olduğundan emin olun, bu bağlantı havuzu oluşturma devre dışı bırakıldı ve veritabanı uygulama hata ayıklama seçeneğinin etkin olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="c01d6-219">If the breakpoint in the `Products_SelectByCategoryID` stored procedure is not hit when visiting the `ExistingSprocs.aspx` page, make sure that the SQL Server checkbox has been checked in the Debuggers section of the ASP.NET application s Properties Page, that connection pooling has been disabled, and that the database s Application Debugging option is enabled.</span></span> <span data-ttu-id="c01d6-220">Hala sorun yaşıyorsanız, Visual Studio 'Yu yeniden başlatıp tekrar deneyin.</span><span class="sxs-lookup"><span data-stu-id="c01d6-220">If you re still having problems, restart Visual Studio and try again.</span></span>

## <a name="debugging-t-sql-database-objects-on-remote-instances"></a><span data-ttu-id="c01d6-221">Uzak örneklerde T-SQL veritabanı nesnelerinde hata ayıklama</span><span class="sxs-lookup"><span data-stu-id="c01d6-221">Debugging T-SQL Database Objects on Remote Instances</span></span>

<span data-ttu-id="c01d6-222">SQL Server veritabanı örneği Visual Studio ile aynı makineli olduğunda, Visual Studio aracılığıyla veritabanı nesnelerinin hatalarını ayıklama oldukça basittir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-222">Debugging database objects through Visual Studio is fairly straightforward when the SQL Server database instance is on the same machine as Visual Studio.</span></span> <span data-ttu-id="c01d6-223">Ancak, SQL Server ve Visual Studio farklı makinelerde bulunuyorsa, her şeyin düzgün şekilde çalışmasını sağlamak için bazı dikkatli bir yapılandırma gerekir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-223">However, if SQL Server and Visual Studio reside on different machines then some careful configuration is required to get everything working properly.</span></span> <span data-ttu-id="c01d6-224">Karşılaştığı iki temel görev vardır:</span><span class="sxs-lookup"><span data-stu-id="c01d6-224">There are two core tasks we are faced with:</span></span>

- <span data-ttu-id="c01d6-225">ADO.NET aracılığıyla veritabanına bağlanmak için kullanılan oturumun `sysadmin` rolüne ait olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="c01d6-225">Ensure that the login used to connect to the database via ADO.NET belongs to the `sysadmin` role.</span></span>
- <span data-ttu-id="c01d6-226">Geliştirme makinesinde Visual Studio tarafından kullanılan Windows Kullanıcı hesabının, `sysadmin` rolüne ait geçerli bir SQL Server oturum açma hesabı olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="c01d6-226">Ensure that the Windows user account used by Visual Studio on the development machine is a valid SQL Server login account that belongs to the `sysadmin` role.</span></span>

<span data-ttu-id="c01d6-227">İlk adım nispeten basittir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-227">The first step is relatively straightforward.</span></span> <span data-ttu-id="c01d6-228">İlk olarak, ASP.NET uygulamasından veritabanına bağlanmak için kullanılan Kullanıcı hesabını belirleyip SQL Server Management Studio ' den bu oturum açma hesabını `sysadmin` rolüne ekleyin.</span><span class="sxs-lookup"><span data-stu-id="c01d6-228">First, identify the user account used to connect to the database from the ASP.NET application and then, from SQL Server Management Studio, add that login account to the `sysadmin` role.</span></span>

<span data-ttu-id="c01d6-229">İkinci görev, uygulamanın hatalarını ayıklamak için kullandığınız Windows Kullanıcı hesabının uzak veritabanında geçerli bir oturum açma olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-229">The second task requires that the Windows user account you use to debug the application be a valid login on the remote database.</span></span> <span data-ttu-id="c01d6-230">Ancak, iş istasyonunuzda oturum açtığınız Windows hesabı, SQL Server üzerinde geçerli bir oturum değil.</span><span class="sxs-lookup"><span data-stu-id="c01d6-230">However, chances are the Windows account you logged on to your workstation with is not a valid login on SQL Server.</span></span> <span data-ttu-id="c01d6-231">SQL Server için belirli bir oturum açma hesabınızı eklemek yerine, bazı Windows Kullanıcı hesaplarını SQL Server hata ayıklama hesabı olarak belirlemek daha iyi bir seçimdir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-231">Rather than adding your particular login account to SQL Server, a better choice would be to designate some Windows user account as the SQL Server debugging account.</span></span> <span data-ttu-id="c01d6-232">Ardından, uzak bir SQL Server örneğinin veritabanı nesnelerinde hata ayıklaması yapmak için, Windows oturum açma hesabı s kimlik bilgilerini kullanarak Visual Studio 'Yu çalıştırırsınız.</span><span class="sxs-lookup"><span data-stu-id="c01d6-232">Then, to debug the database objects of a remote SQL Server instance, you would run Visual Studio using that Windows login account s credentials.</span></span>

<span data-ttu-id="c01d6-233">Bir örnek, şeyleri açıklığa kavuşturmasına yardımcı olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-233">An example should help clarify things.</span></span> <span data-ttu-id="c01d6-234">Windows etki alanı içinde `SQLDebug` adlı bir Windows hesabı olduğunu düşünün.</span><span class="sxs-lookup"><span data-stu-id="c01d6-234">Imagine that there is a Windows account named `SQLDebug` within the Windows domain.</span></span> <span data-ttu-id="c01d6-235">Bu hesabın, uzak SQL Server örneğine geçerli bir oturum açma ve `sysadmin` rolünün bir üyesi olarak eklenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-235">This account would need to be added to the remote SQL Server instance as a valid login and as a member of the `sysadmin` role.</span></span> <span data-ttu-id="c01d6-236">Daha sonra Visual Studio 'da uzak SQL Server örneğinde hata ayıklamak için, Visual Studio 'Yu `SQLDebug` Kullanıcı olarak çalıştırmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-236">Then, to debug the remote SQL Server instance from Visual Studio, we would need to run Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="c01d6-237">Bu işlem iş istasyonumuzu günlüğe kaydederek, `SQLDebug`olarak yeniden oturum açarak ve sonra Visual Studio 'yu başlatarak, iş istasyonumuzdan kendi kimlik bilgilerinizle oturum açıp `SQLDebug` Kullanıcı olarak Visual Studio 'Yu başlatmak için `runas.exe` kullanmaktan daha basit bir yaklaşım olabilir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-237">This could be done by logging out of our workstation, logging back in as `SQLDebug`, and then launching Visual Studio, but a simpler approach would be to login to our workstation using our own credentials and then use `runas.exe` to launch Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="c01d6-238">`runas.exe`, belirli bir uygulamanın farklı bir kullanıcı hesabının GUISE altında yürütülmesini sağlar.</span><span class="sxs-lookup"><span data-stu-id="c01d6-238">`runas.exe` allows a particular application to be executed under the guise of a different user account.</span></span> <span data-ttu-id="c01d6-239">Visual Studio 'Yu `SQLDebug`olarak başlatmak için komut satırına aşağıdaki ifadeyi girebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="c01d6-239">To launch Visual Studio as `SQLDebug`, you could enter the following statement at the command line:</span></span>

[!code-console[Main](debugging-stored-procedures-vb/samples/sample2.cmd)]

<span data-ttu-id="c01d6-240">Bu işlemle ilgili daha ayrıntılı bir açıklama için, bkz. [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Guide for Visual Studio ve SQL Server, yedinci sürüm ve* [hata ayıklama için SQL Server izinleri ayarlama](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="c01d6-240">For a more detailed explanation on this process, see [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Guide to Visual Studio and SQL Server, Seventh Edition* as well as [How To: Set SQL Server Permissions for Debugging](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="c01d6-241">Geliştirme makineniz Windows XP Service Pack 2 çalıştırıyorsa, Internet bağlantısı güvenlik duvarını uzaktan hata ayıklamaya izin verecek şekilde yapılandırmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-241">If your development machine is running Windows XP Service Pack 2 you will need to configure the Internet Connection Firewall to allow remote debugging.</span></span> <span data-ttu-id="c01d6-242">[Nasıl yapılır: etkinleştirme SQL Server 2005 hata ayıklama](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) makalesinde, Visual Studio konak makinesinde iki adım vardır: (a), özel durumlar listesine `Devenv.exe` eklemenız ve TCP 135 bağlantı noktasını açmanız gerekir. ve (b) uzak (SQL) makinede, TCP 135 bağlantı noktasını açmanız ve özel durumlar listesine `sqlservr.exe` eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-242">[The How To: Enable SQL Server 2005 Debugging](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) article notes that this involves two steps: (a) On the Visual Studio host machine, you must add `Devenv.exe` to the Exceptions list and open the TCP 135 port; and (b) On the remote (SQL) machine, you must open the TCP 135 port and add `sqlservr.exe` to the Exceptions list.</span></span> <span data-ttu-id="c01d6-243">Etki alanı ilkeniz IPSec üzerinden ağ iletişimi yapılmasını gerektiriyorsa, UDP 4500 ve UDP 500 bağlantı noktalarını açmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-243">If your domain policy requires network communication to be done through IPSec, you must open the UDP 4500 and UDP 500 ports.</span></span>

## <a name="summary"></a><span data-ttu-id="c01d6-244">Özet</span><span class="sxs-lookup"><span data-stu-id="c01d6-244">Summary</span></span>

<span data-ttu-id="c01d6-245">Visual Studio, .NET uygulama kodu için hata ayıklama desteği sağlamaya ek olarak SQL Server 2005 için çeşitli hata ayıklama seçenekleri de sağlar.</span><span class="sxs-lookup"><span data-stu-id="c01d6-245">In addition to providing debugging support for .NET application code, Visual Studio also provides a variety of debugging options for SQL Server 2005.</span></span> <span data-ttu-id="c01d6-246">Bu öğreticide, bu seçeneklerden ikisini de inceledik: doğrudan veritabanı hata ayıklaması ve uygulama hata ayıklaması.</span><span class="sxs-lookup"><span data-stu-id="c01d6-246">In this tutorial we looked at two of those options: Direct Database Debugging and application debugging.</span></span> <span data-ttu-id="c01d6-247">T-SQL veritabanı nesnesinde doğrudan hata ayıklamak için, Sunucu Gezgini nesneyi bulun, sonra sağ tıklayıp adımla ' yı seçin.</span><span class="sxs-lookup"><span data-stu-id="c01d6-247">To directly debug a T-SQL database object, locate the object through the Server Explorer then right-click on it and choose Step Into.</span></span> <span data-ttu-id="c01d6-248">Bu, hata ayıklayıcıyı ve veritabanı nesnesindeki ilk deyimde halleri başlatır. bu noktada, nesne s deyimlerinde adım adım ve parametre değerlerini görüntüleyebilir ve değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-248">This starts the debugger and halts on the first statement in the database object, at which point you can step through the object s statements and view and modify parameter values.</span></span> <span data-ttu-id="c01d6-249">Adım 1 ' de bu yaklaşımı `Products_SelectByCategoryID` saklı yordamının içine adımla kullandık.</span><span class="sxs-lookup"><span data-stu-id="c01d6-249">In Step 1 we used this approach to step into the `Products_SelectByCategoryID` stored procedure.</span></span>

<span data-ttu-id="c01d6-250">Uygulama hata ayıklaması, kesme noktalarının doğrudan veritabanı nesneleri içinde ayarlamaya izin verir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-250">Application debugging allows breakpoints to be set directly within the database objects.</span></span> <span data-ttu-id="c01d6-251">Kesme noktaları olan bir veritabanı nesnesi bir istemci uygulamasından çağrıldığında (örneğin, bir ASP.NET Web uygulaması), program hata ayıklayıcı üzerinde sürer.</span><span class="sxs-lookup"><span data-stu-id="c01d6-251">When a database object with breakpoints is invoked from a client application (such as an ASP.NET web application), the program halts as the debugger takes over.</span></span> <span data-ttu-id="c01d6-252">Uygulama hata ayıklaması, belirli bir veritabanı nesnesinin çağrılmasına neden olan uygulama eylemini daha açık bir şekilde gösterdiği için yararlıdır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-252">Application debugging is useful because it more clearly shows what application action causes a particular database object to be invoked.</span></span> <span data-ttu-id="c01d6-253">Ancak, doğrudan veritabanı hata ayıklamadan biraz daha fazla yapılandırma ve kurulum gerektirir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-253">However, it requires a bit more configuration and setup than Direct Database Debugging.</span></span>

<span data-ttu-id="c01d6-254">Veritabanı nesneleri SQL Server projeler aracılığıyla da hata ayıklanabilir.</span><span class="sxs-lookup"><span data-stu-id="c01d6-254">Database objects can also be debugged through SQL Server Projects.</span></span> <span data-ttu-id="c01d6-255">SQL Server projelerini ve bir sonraki öğreticide yönetilen veritabanı nesneleri oluşturmak ve hatalarını ayıklamak için bunları nasıl kullanacağınızı inceleyeceğiz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-255">We will look at using SQL Server Projects and how to use them to create and debug managed database objects in the next tutorial.</span></span>

<span data-ttu-id="c01d6-256">Programlamanın kutlu olsun!</span><span class="sxs-lookup"><span data-stu-id="c01d6-256">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c01d6-257">Yazar hakkında</span><span class="sxs-lookup"><span data-stu-id="c01d6-257">About the Author</span></span>

<span data-ttu-id="c01d6-258">4GuysFromRolla.com 'in, [Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), yedi ASP/ASP. net books ve [](http://www.4guysfromrolla.com)'in yazarı, 1998 sürümünden bu yana Microsoft Web teknolojileriyle çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="c01d6-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c01d6-259">Scott bağımsız danışman, Trainer ve yazıcı olarak çalışıyor.</span><span class="sxs-lookup"><span data-stu-id="c01d6-259">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c01d6-260">En son kitabı, [*24 saat içinde ASP.NET 2,0 kendi kendinize eğitim*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)ister.</span><span class="sxs-lookup"><span data-stu-id="c01d6-260">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c01d6-261">mitchell@4GuysFromRolla.comadresinden erişilebilir [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c01d6-261">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c01d6-262">ya da blog aracılığıyla [http://ScottOnWriting.NET](http://ScottOnWriting.NET)bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="c01d6-262">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c01d6-263">[Önceki](protecting-connection-strings-and-other-configuration-information-vb.md)
> [İleri](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c01d6-263">[Previous](protecting-connection-strings-and-other-configuration-information-vb.md)
[Next](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span></span>
